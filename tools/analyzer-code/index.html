<textarea id="in1" style="width:300px; height:300px;"></textarea>
<textarea id="in2" style="width:300px; height:300px;"></textarea>
<textarea id="out" style="width:300px; height:300px;"></textarea>
<br/>
<button id="proc">Proccess</button>
<script>

function proccessCode(input){
	let lines = input.split("\n");
	
	let pos = 0;
	let func = {};
	let functions = [];
	for (let l=0; l<lines.length; l++){
		let line = { "str": lines[l], "pos": pos };
		lines[l].pos = pos;
		if (lines[l]=="//"){
			l++;
			let name = lines[l].replaceAll(/[^a-zA-Z_0-9]/g, '');
			l++;
			pos += 25;
			func = { "name": name, "pos": pos, "lines": [] };
			functions.push(func);
		}
		else if (lines[l].length == 0){
			pos++;
		}
		else {
			let code = line.str.split("//")[0].split("*/")[1].trim();
			line.code = code;
			line.parts = code.replaceAll(/[\(\)\,]/g, '').split(' ');
			
			func.lines.push(line);
			lines[l] = line;
			pos += line.str.length + 1;
		}
	}
	return functions;
}

function findSimilarFunction(fun1, f2) {
	mainloop: for (let i = 0; i < f2.length; i++) {
		if (fun1.lines.length != f2[i].lines.length) continue;
		for (let l = 0; l < fun1.lines.length; l++){
			let line1 = fun1.lines[l];
			let line2 = f2[i].lines[l];
			
			for (let a = 0; a < line1.parts.length; a++){
				let a1 = line1.parts[a];
				let a2 = line2.parts[a];
				if (isNaN(a1)!=isNaN(a2)) continue mainloop;
				if (!isNaN(a1)) continue;
				if (a1 != a2) continue mainloop;
			}
		}
		
		fun1.similar = f2[i];
		f2.splice(i, 1);
		return true;
	}
	return false;
}

proc.onclick = function() {
	let f1 = proccessCode(in1.value); f1.pop();
	let f2 = proccessCode(in2.value); f2.pop();
	let f3 = [];
	
	for (let i = 0; i < f1.length; i++) {
		console.log(i);
		if (findSimilarFunction(f1[i], f2)){
			f3.push(f1.splice(i, 1)[0]);
			i--;
		}
	}
	
	console.log(f1);
	console.log(f2);
	console.log(f3);
}


</script>